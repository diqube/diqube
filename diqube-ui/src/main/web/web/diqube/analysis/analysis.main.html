<!--

    diqube: Distributed Query Base.

    Copyright (C) 2015 Bastian Gloeckle

    This file is part of diqube.

    diqube is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->
<h1 class="page-header">{{title}} <small>{{analysis?.table}}</small></h1>

<div *ngIf="error" class="alert alert-danger">
  <i class="fa fa-exclamation-circle"></i>
  {{ error }}
</div>

<div *ngIf="showNewerVersionWarning()" class="alert alert-warning">
  <b>Warning!</b> You are currently viewing an old version of this analysis. If you make any changes, that will then
  become the newest version and you might lose (or be unable to find) the currently newest version any more. 
  <a [routerLink]="[ '/Analysis/Main', {analysisId: analysis.id, analysisVersion: newestVersionNumber() }]">Load the currently newest version 
  ({{ newestVersionNumber() }}) now.</a>  
</div>

<div *ngIf="showDifferentOwnerWarning()" class="alert alert-warning">
  <b>Warning!</b> This analysis is owned by <b>{{ analysis.user }}</b>, which means you cannot adjust this analysis.
  <a href (click)="cloneAndLoadCurrentAnalysis()">Clone this version of the analysis for your own user.</a> 
</div>

<div *ngIf="!error" class="analysis-container">
  <div class="container-fluid text-justify qube-container">
    <button class="btn btn-default add-qube-btn" (click)="addQube()">
      <i class="fa fa-plus add-action"></i> Add qube
    </button>

    <div *ngFor="#qube of analysis?.qubes" class="qube-row">
      <diqube-analysis-qube [analysis]="analysis" [qube]="qube"></diqube-analysis-qube>
    </div>
  </div>
  
  <div class="slice-container">
    <div class="panel panel-default">
      <div class="panel-heading">
        <span class="slice-container-heading-item"><i class="fa fa-pie-chart"></i> Slices</span>
        <button class="btn btn-default slice-container-heading-item" (click)="addSlice()" title="Add slice">
          <i class="fa fa-plus add-action"></i></button>
      </div>
      <div class="panel-body">
        <diqube-slices [analysis]="analysis"></diqube-slices>
      </div>
    </div>
  </div>
</div>